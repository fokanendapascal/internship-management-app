<div class="container my-5">
    <h2 class="text-center mb-4">Liste des Utilisateurs</h2>

    <button class="btn btn-primary mb-3" (click)="addNewUser()">
        <i class="fa fa-plus"></i> Ajouter un utilisateur
    </button>

    <div *ngIf="loading && users.length === 0" class="text-center my-5">
        Chargement de la liste des utilisateurs...
    </div>

    <div *ngIf="error" class="alert alert-danger text-center my-5">
        {{ error }}
    </div>

    <div *ngIf="loading && users.length > 0" class="alert alert-info text-center">
        Mise à jour en cours...
    </div>

    <div class="table-responsive" *ngIf="users.length > 0">
        <table class="table table-striped table-hover shadow-sm">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Prénom</th>
                    <th>Nom</th>
                    <th>Email</th>
                    <th>Téléphone</th>
                    <th>Rôles</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let user of users">
                    <td>{{ user.id }}</td>
                    <td>{{ user.firstName }}</td>
                    <td>{{ user.lastName }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.telephone || 'N/A' }}</td>
                    <td>
                        <span *ngFor="let role of user.roles"
                            class="badge me-1"
                            [ngClass]="getRoleBadgeClass(role)">
                        {{ getFormattedRole(role) }}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-warning me-2" (click)="editUser(user.id)">
                            <i class="fa fa-edit"></i> Modifier
                        </button>

                        <button *ngIf="hasSpecialRole(user.roles)"
                                class="btn btn-sm btn-info me-2"
                                (click)="goToSpecialization(user)"
                                title="Compléter le profil">
                            <i class="fa fa-user-graduate"></i>Profil
                        </button>

                        <button class="btn btn-sm btn-danger"
                                (click)="removeUser(user.id)"
                                [disabled]="loading">
                            <i class="fa fa-trash"></i> Supprimer
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div *ngIf="users.length === 0 && !loading" class="alert alert-info text-center mt-4">
        Aucun utilisateur trouvé.
    </div>
</div>
